



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="idealo Data Science Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>CNN - Image-dedup</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-137434942-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#class-cnn" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Image-dedup" class="md-header-nav__button md-logo">
          
            <img src="../../img/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Image-dedup
            </span>
            <span class="md-header-nav__topic">
              CNN
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/idealo/image-dedup/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    idealo/image-dedup
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Image-dedup" class="md-nav__button md-logo">
      
        <img src="../../img/logo.svg" width="48" height="48">
      
    </a>
    Image-dedup
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/idealo/image-dedup/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    idealo/image-dedup
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Evaluation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Evaluation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../evaluation/evaluation/" title="Evaluation" class="md-nav__link">
      Evaluation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" checked>
    
    <label class="md-nav__link" for="nav-2-2">
      Methods
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        CNN
      </label>
    
    <a href="./" title="CNN" class="md-nav__link md-nav__link--active">
      CNN
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-cnn" title="class CNN" class="md-nav__link">
    class CNN
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9595init9595" title="__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode95image" title="encode_image" class="md-nav__link">
    encode_image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode95images" title="encode_images" class="md-nav__link">
    encode_images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_1" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_1" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find95duplicates" title="find_duplicates" class="md-nav__link">
    find_duplicates
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_2" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_2" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_2" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find95duplicates95to95remove" title="find_duplicates_to_remove" class="md-nav__link">
    find_duplicates_to_remove
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_3" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_3" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_3" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hashing/" title="Hashing" class="md-nav__link">
      Hashing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Utils
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Utils
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../utils/plotter/" title="Plot duplicates" class="md-nav__link">
      Plot duplicates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../CONTRIBUTING/" title="Contribution" class="md-nav__link">
      Contribution
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../LICENSE/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-cnn" title="class CNN" class="md-nav__link">
    class CNN
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9595init9595" title="__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode95image" title="encode_image" class="md-nav__link">
    encode_image
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encode95images" title="encode_images" class="md-nav__link">
    encode_images
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_1" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_1" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find95duplicates" title="find_duplicates" class="md-nav__link">
    find_duplicates
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_2" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_2" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_2" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find95duplicates95to95remove" title="find_duplicates_to_remove" class="md-nav__link">
    find_duplicates_to_remove
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#args_3" title="Args" class="md-nav__link">
    Args
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returns_3" title="Returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_3" title="Example usage" class="md-nav__link">
    Example usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/idealo/image-dedup/edit/master/docs/methods/cnn.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>CNN</h1>
                
                <h2 id="class-cnn">class CNN</h2>
<p>Find duplicates using CNN and/or generate CNN features given a single image or a directory of images.</p>
<p>The module can be used for 2 purposes: Feature generation and duplicate detection.</p>
<ul>
<li>
<p>Feature generation: To propagate an image through a Convolutional Neural Network architecture and generate features. The generated features can be used at a later time for deduplication. Using the method 'encode_image', the CNN feature for a single image can be obtained while the 'encode_images' method can be used to get features for all images in a directory.</p>
</li>
<li>
<p>Duplicate detection: Find duplicates either using the feature mapping generated previously using 'encode_images' or using a Path to the directory that contains the images that need to be deduplicated. 'find_duplciates' and 'find_duplicates_to_remove' methods are provided to accomplish these tasks.</p>
</li>
</ul>
<h3 id="9595init9595">__init__</h3>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">()</span>
</pre></div>


<p>Initialize a keras MobileNet model that is sliced at the last convolutional layer. Set the batch size for keras generators to be 64 samples. Set the input image size to (224, 224) for providing as input to MobileNet model.</p>
<h3 id="encode95image">encode_image</h3>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">encode_image</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">image_array</span><span class="p">)</span>
</pre></div>


<p>Generate CNN features for a single image.</p>
<h5 id="args">Args</h5>
<ul>
<li>
<p><strong>image_file</strong>: Path to the image file.</p>
</li>
<li>
<p><strong>image_array</strong>: Image typecast to numpy array.</p>
</li>
</ul>
<h5 id="returns">Returns</h5>
<ul>
<li><strong>feature</strong>: Features for the image in the form of numpy array.</li>
</ul>
<h5 id="example-usage">Example usage</h5>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">feature_vector</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image_file</span><span class="o">=</span><span class="s1">&#39;path/to/image.jpg&#39;</span><span class="p">)</span>
<span class="n">OR</span>
<span class="n">feature_vector</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image_array</span><span class="o">=&lt;</span><span class="n">numpy</span> <span class="n">array</span> <span class="n">of</span> <span class="n">image</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>


<h3 id="encode95images">encode_images</h3>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">encode_images</span><span class="p">(</span><span class="n">image_dir</span><span class="p">)</span>
</pre></div>


<p>Generate CNN features for all images in a given directory of images.</p>
<h5 id="args_1">Args</h5>
<ul>
<li><strong>image_dir</strong>: Path to the image directory.</li>
</ul>
<h5 id="returns_1">Returns</h5>
<ul>
<li><strong>dictionary</strong>: Contains a mapping of filenames and corresponding numpy array of CNN features.</li>
</ul>
<h5 id="example-usage_1">Example usage</h5>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">feature_map</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">encode_images</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/image/directory&#39;</span><span class="p">)</span>
</pre></div>


<h3 id="find95duplicates">find_duplicates</h3>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">find_duplicates</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">encoding_map</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
</pre></div>


<p>Find duplicates for each file. Take in path of the directory or encoding dictionary in which duplicates are to be detected above the given threshold. Return dictionary containing key as filename and value as a list of duplicate file names. Optionally, the cosine distances could be returned instead of just duplicate filenames for each query file.</p>
<h5 id="args_2">Args</h5>
<ul>
<li>
<p><strong>image_dir</strong>: Path to the directory containing all the images or dictionary with keys as file names</p>
</li>
<li>
<p><strong>encoding_map</strong>: A dictionary containing mapping of filenames and corresponding CNN features.</p>
</li>
<li>
<p><strong>min_similarity_threshold</strong>: Threshold value (must be float between -1.0 and 1.0)</p>
</li>
<li>
<p><strong>scores</strong>: Boolean indicating whether similarity scores are to be returned along with retrieved duplicates.</p>
</li>
<li>
<p><strong>outfile</strong>: Name of the file to save the results.</p>
</li>
</ul>
<h5 id="returns_2">Returns</h5>
<ul>
<li><strong>dictionary</strong>:  if scores is True, then a dictionary of the form {'image1.jpg': [('image1_duplicate1.jpg',
            score), ('image1_duplicate2.jpg', score)], 'image2.jpg': [] ..}. if scores is False, then a
            dictionary of the form {'image1.jpg': ['image1_duplicate1.jpg', 'image1_duplicate2.jpg'],
            'image2.jpg':['image1_duplicate1.jpg',..], ..}</li>
</ul>
<h5 id="example-usage_2">Example usage</h5>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/directory&#39;</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>

<span class="n">OR</span>

<span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates</span><span class="p">(</span><span class="n">encoding_map</span><span class="o">=&lt;</span><span class="n">mapping</span> <span class="n">filename</span> <span class="n">to</span> <span class="n">cnn</span> <span class="n">features</span><span class="o">&gt;</span><span class="p">,</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>
</pre></div>


<h3 id="find95duplicates95to95remove">find_duplicates_to_remove</h3>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">find_duplicates_to_remove</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">encoding_map</span><span class="p">,</span> <span class="n">min_similarity_threshold</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
</pre></div>


<p>Give out a list of image file names to remove based on the similarity threshold. Does not remove the mentioned files.</p>
<h5 id="args_3">Args</h5>
<ul>
<li>
<p><strong>image_dir</strong>: Path to the directory containing all the images or dictionary with keys as file names
           and values as numpy arrays which represent the CNN feature for the key image file.</p>
</li>
<li>
<p><strong>encoding_map</strong>: A dictionary containing mapping of filenames and corresponding CNN features.</p>
</li>
<li>
<p><strong>min_similarity_threshold</strong>: Threshold value (must be float between -1.0 and 1.0)</p>
</li>
<li>
<p><strong>outfile</strong>: Name of the file to save the results.</p>
</li>
</ul>
<h5 id="returns_3">Returns</h5>
<ul>
<li><strong>duplicates</strong>: List of image file names that should be removed.</li>
</ul>
<h5 id="example-usage_3">Example usage</h5>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates_to_remove</span><span class="p">(</span><span class="n">image_dir</span><span class="o">=</span><span class="s1">&#39;path/to/images/directory&#39;</span><span class="p">),</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">OR</span>

<span class="kn">from</span> <span class="nn">imagededup.methods</span> <span class="kn">import</span> <span class="n">CNN</span>
<span class="n">myencoder</span> <span class="o">=</span> <span class="n">CNN</span><span class="p">()</span>
<span class="n">duplicates</span> <span class="o">=</span> <span class="n">myencoder</span><span class="o">.</span><span class="n">find_duplicates_to_remove</span><span class="p">(</span><span class="n">encoding_map</span><span class="o">=&lt;</span><span class="n">mapping</span> <span class="n">filename</span> <span class="n">to</span> <span class="n">cnn</span> <span class="n">features</span><span class="o">&gt;</span><span class="p">,</span>
<span class="n">min_similarity_threshold</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;results.json&#39;</span><span class="p">)</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../evaluation/evaluation/" title="Evaluation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Evaluation
              </span>
            </div>
          </a>
        
        
          <a href="../hashing/" title="Hashing" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Hashing
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>